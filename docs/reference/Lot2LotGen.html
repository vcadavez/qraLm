<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function Lot2LotGen() generates a matrix of contaminated lots from information on
the parameters of a beta distribution (alpha, beta) representing the between-lot variability in prevalence;
the parameters of a normal distribution (mean, sd) representing the total variability in the microbial concentration
in the contaminated units (log10 CFU/g); and the proportion of such total variance assigned to between-lot variance.
Every row of the matrix corresponds to a production lot, broken down in units or portions, which are the columns of the matrix."><title>Generation of contaminated lots with variability in prevalence and concentration — Lot2LotGen • qraLm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generation of contaminated lots with variability in prevalence and concentration — Lot2LotGen"><meta property="og:description" content="The function Lot2LotGen() generates a matrix of contaminated lots from information on
the parameters of a beta distribution (alpha, beta) representing the between-lot variability in prevalence;
the parameters of a normal distribution (mean, sd) representing the total variability in the microbial concentration
in the contaminated units (log10 CFU/g); and the proportion of such total variance assigned to between-lot variance.
Every row of the matrix corresponds to a production lot, broken down in units or portions, which are the columns of the matrix."><meta property="og:image" content="https://vcadavez.github.io/qraLm/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qraLm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://github.com/vcadavez/qraLm/">Version 0.1.1</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vcadavez/qraLm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generation of contaminated lots with variability in prevalence and concentration</h1>
      <small class="dont-index">Source: <a href="https://github.com/vcadavez/qraLm/blob/HEAD/R/Lot2LotGen.R" class="external-link"><code>R/Lot2LotGen.R</code></a></small>
      <div class="d-none name"><code>Lot2LotGen.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>Lot2LotGen()</code> generates a matrix of contaminated lots from information on
the parameters of a beta distribution (<code>alpha</code>, <code>beta</code>) representing the between-lot variability in prevalence;
the parameters of a normal distribution (<code>mean</code>, <code>sd</code>) representing the total variability in the microbial concentration
in the contaminated units (<code>log10 CFU/g</code>); and the proportion of such total variance assigned to between-lot variance.
Every row of the matrix corresponds to a production lot, broken down in units or portions, which are the columns of the matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Lot2LotGen</span><span class="op">(</span></span>
<span>  <span class="va">nLots</span>,</span>
<span>  <span class="va">sizeLot</span>,</span>
<span>  <span class="va">unitSize</span>,</span>
<span>  <span class="va">betaAlpha</span>,</span>
<span>  <span class="va">betaBeta</span>,</span>
<span>  <span class="va">C0MeanLog</span>,</span>
<span>  <span class="va">C0SdLog</span>,</span>
<span>  <span class="va">propVarInter</span>,</span>
<span>  Poisson <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>nLots</dt>
<dd><p>Number of lots sampled or size of the Monte Carlo simulation (scalar).</p></dd>


<dt>sizeLot</dt>
<dd><p>Number of units or portions produced in a lot (scalar).</p></dd>


<dt>unitSize</dt>
<dd><p>Weight (<code>g</code>) of single unit or portion from a lot (scalar).</p></dd>


<dt>betaAlpha</dt>
<dd><p>Parameter <code>alpha</code> of the beta distribution representing the
between-batch variability in prevalence (scalar).</p></dd>


<dt>betaBeta</dt>
<dd><p>Parameter <code>beta</code> of the beta distribution representing the
between-batch variability in prevalence (scalar).</p></dd>


<dt>C0MeanLog</dt>
<dd><p>Mean parameter (<code>log10 CFU/g</code>) of the normal distribution representing
the total variability in the microbial concentration of contaminated units (scalar or vector).</p></dd>


<dt>C0SdLog</dt>
<dd><p>Standard deviation parameter (<code>log10 CFU/g</code>) of the normal distribution
representing the total variability in the microbial concentration of contaminated units (scalar or vector).</p></dd>


<dt>propVarInter</dt>
<dd><p>proportion of the total variance (\(C0\_sdLog10^2\)) attributed
to between-lot variance. The remaining (<code>1-propVarInter</code>) is the proportion of within-lot variance.</p></dd>


<dt>Poisson</dt>
<dd><p>need to be defined</p></dd>


<dt>...</dt>
<dd><p>Other options used to control <code><a href="LotGen.html">LotGen()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of four elements:</p><dl><dt><code>N</code></dt>
<dd><p>(<code>CFU</code>) A matrix of size <code>nLots</code> lots by <code>sizeLot</code> units representing the microbial numbers
in the units or portions from contaminated lots;</p></dd>

<dt><code>ProbUnitPos</code></dt>
<dd><p>Probability that the lot is contaminated (a lot is considered contaminated if at
least one unit or portion is contaminated) (vector);</p></dd>

<dt><code>P</code></dt>
<dd><p>Mean prevalence of contaminated lots (scalar);</p></dd>

<dt><code>betaGen</code></dt>
<dd><p>True prevalence of contaminated units in the lots (sampled from the beta distribution) (vector).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function requires that the variability in the prevalence of <em>L. monocytogenes</em> between lots is
represented by a beta distribution.
To determine the parameters of such a beta distribution, a beta-binomial distribution was fitted to survey data
(compiled in Table 3.21 of WHO (2022)
, consisting of positive samples and total sample size.
The beta-binomial was fitted through a Markov-Chain Monte Carlo approach, with <code>gamma(0.01, 0.01)</code> as priors for both parameters,
and assuming that every data source (a published paper) represents a different lot. The parameters of the beta distribution
were determined at: <code>betaAlpha=0.5112</code> and <code>betaBeta=9.959</code>.
The mean (<code>C0MeanLog=1.023</code> log10 CFU/g) and standard deviation (<code>C0SdLog=0.3267</code> log10\ CFU/g) of the normal distribution
representing the overall variability in <em>L. monocytogenes</em> were obtained using data from Jeyaletchumi (2011)

(3.0 MPN/g, 3.6 MPN/g in freshly harvested vegetables), Magdovitz et al. (2021)
 (21, 36 and 75 MPN/g in corn and peas
arriving at the frozen food facility), and Kuan et al. (2017)
 (3.0 MPN/g in bulk carrots at retail).
The algorithm decomposes at the log10 level the total variance in concentration into between-lot variance and within-lot
variance according to the proportion <code>propVarInter</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Team RC (2022).
<em>R: A Language and Environment for Statistical Computing</em>.
R Foundation for Statistical Computing, Vienna, Austria.
<a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.

WHO (2022).
“A Roadmap for the Development of Risk Assessment Models of Listeria monocytogenes in Selected Produce and Seafood Products.”
World Health Organization.

Jeyaletchumi PTRSPMCLCRSFMGCYKMNYNKMP (2011).
“Evaluation of Listeria spp. and Listeria monocytogenes in selected vegetable farms.”
<em>Journal of Tropical Agriculture and Food Science</em>, <b>39</b>(2), 255-266.

Magdovitz BF, Gummalla S, Garren D, Thippareddi H, Berrang ME, Harrison MA (2021).
“Prevalence of Listeria species and Listeria monocytogenes on raw produce arriving at frozen food manufacturing facilities.”
<em>Journal of Food Protection</em>, <b>84</b>(11), 1898-1903.

Kuan CH, Rukayadi Y, Ahmad SH, Wan C, Radzi M, Thung TY, Premarathne J, Chang WS, Loo YY, Tan CW, Ramzi OB, Fadzil SNM, Kuan CS, Yeo SK, Nishibuchi M, Radu S (2017).
“Comparison of the microbiological quality and safety between conventional and organic vegetables sold in Malaysia.”
<em>Frontiers in Microbiology</em>, <b>8</b>, 1433.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other data generation: 
<code><a href="LotGen.html">LotGen</a>()</code>,
<code><a href="caPrimaryProduction.html">caPrimaryProduction</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Vasco Cadavez <a href="mailto:vcadavez@ipb.pt">vcadavez@ipb.pt</a> and Regis Pouillot <a href="mailto:rpouillot.work@gmail.com">rpouillot.work@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">Lot2LotGen</span><span class="op">(</span></span></span>
<span class="r-in"><span>  nLots <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>  sizeLot <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  unitSize <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>  betaAlpha <span class="op">=</span> <span class="fl">0.5112</span>,</span></span>
<span class="r-in"><span>  betaBeta <span class="op">=</span> <span class="fl">9.959</span>,</span></span>
<span class="r-in"><span>  C0MeanLog <span class="op">=</span> <span class="fl">1.023</span>,</span></span>
<span class="r-in"><span>  C0SdLog <span class="op">=</span> <span class="fl">0.3267</span>,</span></span>
<span class="r-in"><span>  propVarInter <span class="op">=</span> <span class="fl">0.7</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">P</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7103589</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.0     0.0     0.0   417.9     0.0 59206.0 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://ipb.pt/vcadavez" class="external-link">Vasco Cadavez</a>, <a href="https://scholar.google.com/citations?hl=en&amp;user=dCv0o0wAAAAJ&amp;view_op=list_works&amp;sortby=pubdate/" class="external-link">Régis Pouillot</a>, <a href="https://ipb.pt/~ubarron/" class="external-link">Ursula Gonzales-Barron</a>, <a href="https://scholar.google.com/citations?user=R6kR2RgAAAAJ&amp;hl=fr/" class="external-link">Laurent Guillier</a>, <a href="https://ch.linkedin.com/in/sanaamo/en/" class="external-link">Moez Sanaa</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

